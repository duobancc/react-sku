(this["webpackJsonpreact-sku"]=this["webpackJsonpreact-sku"]||[]).push([[0],{164:function(e,n,t){},165:function(e,n,t){},289:function(e,n,t){},293:function(e,n,t){"use strict";t.r(n);var c=t(8),a=t(0),i=t.n(a),r=t(33),l=t.n(r),u=(t(164),t(83)),s=t(44),o=t(39),d=t(50),v=(t(165),t(81)),f=t(298),j=t(297),h=t(300),b=t(296),O=function(e,n){var t;return(t=[]).concat.apply(t,Object(s.a)(e.map((function(e){return n.map((function(n){return[].concat(e,n)}))}))))},p=function e(n,t){for(var c=arguments.length,a=new Array(c>2?c-2:0),i=2;i<c;i++)a[i-2]=arguments[i];return t?e.apply(void 0,[O(n,t)].concat(a)):n},x=t(77),m=t.n(x),g=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=16*Math.random()|0;return("x"===e?n:3&n|8).toString(16)}))},k=v.a.Option,y=function(e){var n,t,i=e.skus,r=e.onChange,l=[];null===i||void 0===i||i.forEach((function(e){var c;null===(c=e.properties)||void 0===c||c.forEach((function(e,n){if(e.name&&e.value){var t,c,a=l.find((function(n){return n.name===e.name}));if(a)!(null===(t=a.values)||void 0===t?void 0:t.includes(e.value))&&(null===(c=a.values)||void 0===c||c.push(e.value));else l.push({name:e.name,key:g(),values:[e.value]})}})),1===i.length&&(n=e.price,t=e.hold)}));var u=Object(a.useState)(l),O=Object(o.a)(u,2),x=O[0],y=O[1],N=Object(a.useState)(!1),C=Object(o.a)(N,2),S=C[0],E=C[1],w=Object(a.useState)([]),I=Object(o.a)(w,2),J=I[0],P=I[1],F=Object(a.useState)(null!==i&&void 0!==i?i:[]),q=Object(o.a)(F,2),V=q[0],A=q[1],B={add:function(){y((function(e){return[].concat(Object(s.a)(e),[{name:"",key:g(),values:[]}])}))},remove:function(e){y((function(n){var t=JSON.parse(JSON.stringify(n));return t.splice(e,1),t}))},onChangeName:function(e,n){y((function(t){var c=Object(s.a)(t);return c[e].name=n,c}))},onChangeValues:function(e,n){y((function(t){var c=Object(s.a)(t);return c[e].values=n,c}))}},L=function(e,n){A((function(t){return e.price=n,JSON.parse(JSON.stringify(t))}))},M=function(e,n){A((function(t){return e.hold=Number(n),JSON.parse(JSON.stringify(t))}))};return Object(a.useEffect)((function(){var e=!1,n=[],t=[],a=[];x.forEach((function(t){var c;if(t.name&&(null===(c=t.values)||void 0===c?void 0:c.length)){var i=[];e=!0,n.push({title:t.name,dataIndex:"properties",key:"properties",render:function(e,n,c){var a=e.find((function(e){return e.name===t.name}));return null===a||void 0===a?void 0:a.value}}),t.values.forEach((function(e){i.push({name:t.name,value:e})})),a.push(i)}}));var i=p.apply(void 0,a);null===i||void 0===i||i.forEach((function(e,n){t.push({key:n,skuId:g(),properties:Array.isArray(e)?e:[e]})})),n.push({title:"\u4ef7\u683c",dataIndex:"price",key:"price",width:200,render:function(e,n,t){return Object(c.jsx)(f.a,{value:e,prefix:"\uffe5",required:!0,onChange:function(e){return L(n,e.target.value)}})}}),n.push({title:"\u5e93\u5b58",width:200,dataIndex:"hold",key:"hold",render:function(e,n,t){return Object(c.jsx)(f.a,{value:e,required:!0,onChange:function(e){return M(n,e.target.value)}})}}),E(e),P(n),m.a.isEqual(x,l)||A(t)}),[x]),Object(a.useEffect)((function(){null===r||void 0===r||r(V)}),[V]),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(j.a.Item,{label:"\u5546\u54c1\u89c4\u683c",wrapperCol:{span:18},children:Object(c.jsxs)(h.b,{direction:"vertical",children:[x.map((function(e,n){var t;return Object(c.jsxs)(h.b,{children:[Object(c.jsx)(f.a,{addonBefore:"\u89c4\u683c\u540d",defaultValue:e.name,onChange:function(e){return B.onChangeName(n,e.target.value)}}),Object(c.jsx)(v.a,{mode:"tags",style:{width:400},placeholder:"\u6dfb\u52a0\u89c4\u683c\u5c5e\u6027",value:e.values,onChange:function(e){return B.onChangeValues(n,e)},children:null===e||void 0===e||null===(t=e.values)||void 0===t?void 0:t.map((function(e){return Object(c.jsx)(k,{value:e,children:e},e)}))}),Object(c.jsx)(d.a,{type:"link",danger:!0,onClick:function(){return B.remove(n)},children:"\u5220\u9664"})]},e.key)})),x.length<10&&Object(c.jsx)(d.a,{type:"dashed",onClick:B.add,children:"\u6dfb\u52a0\u89c4\u683c"})]})}),S?Object(c.jsx)(j.a.Item,{label:"\u89c4\u683c\u660e\u7ec6",wrapperCol:{span:16},children:Object(c.jsx)(b.a,{pagination:!1,size:"small",columns:J,dataSource:V,bordered:!0})}):Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(j.a.Item,{label:"\u4ef7\u683c",name:"price",wrapperCol:{span:2},initialValue:n,rules:[{required:!0,message:"\u4ef7\u683c\u4e0d\u80fd\u4e3a\u7a7a"}],children:Object(c.jsx)(f.a,{prefix:"\uffe5"})}),Object(c.jsx)(j.a.Item,{label:"\u5e93\u5b58",name:"hold",initialValue:t,wrapperCol:{span:2},rules:[{required:!S,message:"\u5e93\u5b58\u4e0d\u80fd\u4e3a\u7a7a"}],children:Object(c.jsx)(f.a,{})})]})]})},N=t(299),C=(t(289),0),S=function(e){var n=e.data,t=e.optionsChange,i=e.onPressConfirm,r=Object(a.useState)(1),l=Object(o.a)(r,2),d=l[0],v=l[1],f=Object(a.useState)({}),j=Object(o.a)(f,2),h=j[0],b=j[1],O=Object(a.useState)(!1),p=Object(o.a)(O,2),x=p[0],g=p[1],k=Object(a.useState)(0),y=Object(o.a)(k,2),S=y[0],E=y[1],w=Object(a.useState)(0),I=Object(o.a)(w,2),J=I[0],P=I[1],F=Object(a.useState)(0),q=Object(o.a)(F,2),V=q[0],A=q[1],B=function(e,t){var c=[];if(Object.keys(e).forEach((function(n){var t=e[n].find((function(e){return e.select}));t&&c.push({name:n,value:t.value})})),c.length===Object.keys(e).length){var a=n.skus.find((function(e){return!m.a.xorWith(c,e.properties,m.a.isEqual).length}));return a&&a[null!==t&&void 0!==t?t:""]?a[null!==t&&void 0!==t?t:""]:a||null}},L=function(e){var n,t,c=Object.keys(h),a=c.filter((function(e){return h[e].find((function(e){return e.select}))})).length===c.length;if(e&&e.length||(a=!1),1===(null===e||void 0===e?void 0:e.length)&&!(null===(n=e[0])||void 0===n||null===(t=n.properties)||void 0===t?void 0:t.length)&&e[0].hold<=0&&(a=!1),a){var i=B(h,"hold");d>i&&v(i)}return g(a),a},M=function(e){var t=n.skus;Object.keys(e).forEach((function(n){e[n].forEach((function(e){var c="".concat(n,":").concat(e.value),a=t.find((function(e){return e.properties.find((function(e){return"".concat(e.name,":").concat(e.value)===c}))&&e.hold}));e.disable=!a}))})),b(Object(u.a)({},e))},T=function(e,c){var a,i=!1;v(1);var r=(h[Object.keys(h).find((function(n){return n===e}))||""]||[]).find((function(e){return e.select}))||{};r.select=!1,r===c?i=!0:c.select=!0;var l=Object.keys(h).filter((function(e){return h[e].find((function(e){return e.select}))})).reduce((function(e,n){var t;return[].concat(Object(s.a)(e),["".concat(n,":").concat(null===(t=h[n].find((function(e){return e.select})))||void 0===t?void 0:t.value)])}),[]);i&&(l.length||M(h)),l.length&&function(e){var t=n.skus;Object.keys(h).forEach((function(n){var c=h[Object.keys(h).find((function(e){return n===e}))||""].find((function(e){return e.select}));h[n].forEach((function(a){if(!a.select){var i=Object(s.a)(e);if(c){var r=i.findIndex((function(e){return e==="".concat(n,":").concat(c.value)}));i.splice(r,1)}i.push("".concat(n,":").concat(a.value));var l=[];t.forEach((function(e){i.filter((function(n){return!!e.properties.find((function(e){return"".concat(e.name,":").concat(e.value)===n}))})).length===i.length&&l.push(e)}));var u=l.find((function(e){return e.hold})),o=u?u.hold:0;a.disable=!o}}))})),L(t)}(l);var o=null;o=l.length?B(h,"price"):null===n||void 0===n?void 0:n.minPrice;var d=null!==(a=B(h,"hold"))&&void 0!==a?a:C;b(Object(u.a)({},h)),o&&E(o),P(d),t&&t(h)},z=function(e){var n=d;if("-"===e&&n>1)--n;else if("+"===e)if(x){var t=B(h,"hold");n<t?++n:(N.b.warning("\u6570\u91cf\u4e0d\u80fd\u5927\u4e8e\u5e93\u5b58"),n=t)}else++n;v(n)};return Object(a.useEffect)((function(){!function(){var e,t,c,a=null===n||void 0===n?void 0:n.skus,i=null===n||void 0===n?void 0:n.spec,r=n.skuHold,l={},u=null!==(e=null===n||void 0===n?void 0:n.minPrice)&&void 0!==e?e:0;if(i)l=i,P(r);else{var s={},o=0;null===a||void 0===a||a.forEach((function(e){var n;o+=e.hold,null===e||void 0===e||null===(n=e.properties)||void 0===n||n.forEach((function(e){l[e.name]||(l[e.name]=[],s[e.name]=[]),s[e.name].includes(e.value)||(s[e.name].push(e.value),l[e.name].push({value:e.value,disable:!1,select:!1}))})),e.price>u&&(u=e.price)})),P(o),C=o}var d=!!n.canFlag;1===(null===a||void 0===a?void 0:a.length)&&!(null===(t=a[0].properties)||void 0===t?void 0:t.length)&&a[0].hold<=0&&(d=!1),g(d),E(null!==(c=null===n||void 0===n?void 0:n.minPrice)&&void 0!==c?c:0),A(u),M(l)}(),v((null===n||void 0===n?void 0:n.count)||1)}),[n]),Object(c.jsxs)("div",{className:"drawer-inner",children:[Object(c.jsxs)("div",{className:"prod-info",children:[Object(c.jsx)("div",{className:"prod-img",children:Object(c.jsx)("img",{alt:"",src:n.image})}),Object(c.jsxs)("div",{className:"content",children:[Object(c.jsx)("div",{className:"item-title",children:n.title}),Object(c.jsxs)("div",{children:[Object(c.jsxs)("div",{className:"price-wrap",children:[Object(c.jsxs)("span",{children:["\xa5",S]}),!x&&V>S?Object(c.jsxs)("span",{children:["~ ",V]}):null]}),Object(c.jsxs)("div",{className:"sku-hold",children:["\u5e93\u5b58 ",J," \u4ef6"]})]})]})]}),Object(c.jsxs)("div",{className:"spec-inner",children:[Object.keys(h).map((function(e,n){return Object(c.jsxs)("div",{className:"items",children:[Object(c.jsx)("div",{className:"title",children:e}),Object(c.jsx)("div",{className:"tags",children:h[e].map((function(t,a){return Object(c.jsx)("div",{onClick:function(){return!t.disable&&T(e,t)},className:t.select?"tag active":t.disable?"tag disable":"tag",children:t.value},"".concat(n+a))}))})]},"".concat(n+1))})),Object(c.jsx)("div",{className:"items",children:Object(c.jsxs)("div",{className:"title",children:["\u6570\u91cf",Object(c.jsxs)("div",{className:"count-wrap",children:[Object(c.jsx)("div",{className:"sign",onClick:function(){return z("-")},children:"-"}),Object(c.jsx)("div",{className:"count-box",children:d}),Object(c.jsx)("div",{className:"sign",onClick:function(){return z("+")},children:"+"})]})]})}),Object(c.jsx)("div",{className:"btn-wrap",children:Object(c.jsx)("div",{className:x?"btn":"btn disable",onClick:function(){if(L(null===n||void 0===n?void 0:n.skus)){var e={skuId:B(h,"skuId"),itemId:null===n||void 0===n?void 0:n.itemId,num:d};null===i||void 0===i||i(e)}},children:"\u786e\u8ba4"})})]})]})},E=[],w={title:"react-sku\u7ec4\u4ef6",minPrice:1,itemId:"test_csdfdge8je3nnc"},I=function(){var e=Object(a.useState)([]),n=Object(o.a)(e,2),t=n[0],i=n[1];return Object(c.jsxs)("div",{className:"app",children:[Object(c.jsxs)("div",{className:"sku-creator-wrap",children:[Object(c.jsx)(y,{onChange:function(e){E=e},skus:[]}),Object(c.jsx)(d.a,{onClick:function(){i(Object(s.a)(E))},children:"\u6dfb\u52a0"})]}),Object(c.jsx)("div",{style:{background:"#f7f7f7"},children:Object(c.jsx)("div",{className:"sku-select-wrap",children:Object(c.jsx)(S,{optionsChange:function(e){},onPressConfirm:function(e){},data:Object(u.a)({skus:t},w)})})})]})},J=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,301)).then((function(n){var t=n.getCLS,c=n.getFID,a=n.getFCP,i=n.getLCP,r=n.getTTFB;t(e),c(e),a(e),i(e),r(e)}))};t(292);l.a.render(Object(c.jsx)(i.a.StrictMode,{children:Object(c.jsx)(I,{})}),document.getElementById("root")),J()}},[[293,1,2]]]);
//# sourceMappingURL=main.35899dd2.chunk.js.map